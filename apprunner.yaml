version: 1

# Source & build
source:
  code_repository:
    repository_url: https://github.com/your-org/your-repo
    source_branch: main
    configuration_source: REPOSITORY
  build_configuration:
    runtime: nodejs18
    build_command: npm install && npm run build
    start_command: npm start

# Service definition
service:
  name: ai-answers
  instance_configuration:
    cpu: 512        # 1 vCPU
    memory: 1024     # 1 GB

  # Environment placeholders â”€ App Runner will expect these keys
  environment:
    variables:
      ANTHROPIC_API_KEY:       ${ANTHROPIC_API_KEY}
      OPENAI_API_KEY:          ${OPENAI_API_KEY}
      GOOGLE_API_KEY:          ${GOOGLE_API_KEY}
      GOOGLE_SEARCH_ENGINE_ID: ${GOOGLE_SEARCH_ENGINE_ID}
      DOCDB_URI:               ${DOCDB_URI}
      JWT_SECRET_KEY:          ${JWT_SECRET_KEY}
      NODE_ENV:                ${NODE_ENV}

# Health check (optional override)
health_check:
  protocol: HTTP
  path: /health
  interval: 10
  timeout: 5
  healthy_threshold: 1
  unhealthy_threshold: 10

# Auto-scaling (example)
auto_scaling_configuration:
  min_concurrency: 1
  max_concurrency: 50
